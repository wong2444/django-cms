function Auth(){this.maskWrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper"),this.smsCaptcha=$(".sms-captcha-btn")}function FrontBase(){}Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信驗證碼發送成功"),t.smsCaptcha.addClass("disabled");var n=60;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),(n-=1)<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("發送驗證碼"),t.listenSmsCapthaEvent())},1e3)},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:"0"})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})}),a.click(function(){$(".mask-wrapper").hide()})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),i=t.find("input[name='password']"),o=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=i.val(),e=o.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){200===t.code&&(a.hideEvent(),window.location.reload())}})})},Auth.prototype.listenSmsCapthaEvent=function(){var n=this,e=$(".signup-group input[name='telephone']");n.smsCaptcha.click(function(){var t=e.val();console.log(t),""!==t?xfzajax.get({url:"account/sms_captcha/",data:{telephone:t},success:function(t){200===t.code&&n.smsSuccessEvent()}}):messageBox.showInfo("請輸入手機號碼")})},Auth.prototype.listenSignupEvent=function(){var m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),a=m.find("input[name='img_captcha']"),s=m.find("input[name='password1']"),i=m.find("input[name='password2']"),o=m.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),p=a.val();console.log(p);var u=s.val(),l=i.val(),h=o.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200===t.code&&window.location.reload()}})})},Auth.prototype.run=function(){this.listenShowHideEvent(),this.listenSwitchEvent(),this.listenSigninEvent(),this.listenSignupEvent(),this.listenImgCaptchaEvent(),this.listenSmsCapthaEvent()},$(document).ready(function(){(new Auth).run()}),FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},$(document).ready(function(){(new FrontBase).run(),template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime();console.log(e);var a=((new Date).getTime()-e)/1e3;return a<60?"剛剛":60<a&&a<3600?parseInt(a/60)+"分鐘前":3600<=a&&a<86400?parseInt(a/60/60)+"小時前":86400<=a&&a<2592e3?parseInt(a/60/60/24)+"天前":n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiQXV0aCIsInRoaXMiLCJtYXNrV3JhcHBlciIsIiQiLCJzY3JvbGxXcmFwcGVyIiwic21zQ2FwdGNoYSIsIkZyb250QmFzZSIsInByb3RvdHlwZSIsInNob3dFdmVudCIsInNob3ciLCJoaWRlRXZlbnQiLCJoaWRlIiwic21zU3VjY2Vzc0V2ZW50Iiwic2VsZiIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsImxpc3RlblNtc0NhcHRoYUV2ZW50IiwibGlzdGVuU2hvd0hpZGVFdmVudCIsInNpZ25pbkJ0biIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwiY2xpY2siLCJjc3MiLCJsZWZ0IiwibGlzdGVuSW1nQ2FwdGNoYUV2ZW50IiwiaW1nQ2FwdGNoYSIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwibGlzdGVuU3dpdGNoRXZlbnQiLCJjdXJyZW50TGVmdCIsInBhcnNlSW50IiwiYW5pbWF0ZSIsImxpc3RlblNpZ25pbkV2ZW50Iiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwieGZ6YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVsb2FkIiwiY29uc29sZSIsImxvZyIsImdldCIsInNob3dJbmZvIiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaWdudXBHcm91cCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VybmFtZUlucHV0IiwiaW1nQ2FwdGNoYUlucHV0IiwicGFzc3dvcmQxSW5wdXQiLCJwYXNzd29yZDJJbnB1dCIsInNtc0NhcHRjaGFJbnB1dCIsInVzZXJuYW1lIiwiaW1nX2NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJzbXNfY2FwdGNoYSIsInJ1biIsImRvY3VtZW50IiwicmVhZHkiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBRUEsU0FBU0EsT0FDTEMsS0FBS0MsWUFBY0MsRUFBRSxpQkFDckJGLEtBQUtHLGNBQWdCRCxFQUFFLG1CQUN2QkYsS0FBS0ksV0FBYUYsRUFBRSxvQkFnTXhCLFNBQVNHLGFBN0xUTixLQUFLTyxVQUFVQyxVQUFZLFdBQ3ZCUCxLQUFLQyxZQUFZTyxRQUdyQlQsS0FBS08sVUFBVUcsVUFBWSxXQUN2QlQsS0FBS0MsWUFBWVMsUUFHckJYLEtBQUtPLFVBQVVLLGdCQUFrQixXQUU3QixJQUFJQyxFQUFPWixLQUNYYSxXQUFXQyxZQUFZLGFBQ3ZCRixFQUFLUixXQUFXVyxTQUFTLFlBQ3pCLElBQUlDLEVBQVEsR0FDWkosRUFBS1IsV0FBV2EsT0FBTyxTQUN2QixJQUFJQyxFQUFRQyxZQUFZLFdBQ3BCUCxFQUFLUixXQUFXZ0IsS0FBS0osRUFBUSxNQUM3QkEsR0FBUyxJQUNJLElBQ1RLLGNBQWNILEdBQ2ROLEVBQUtSLFdBQVdrQixZQUFZLFlBQzVCVixFQUFLUixXQUFXZ0IsS0FBSyxTQUNyQlIsRUFBS1cseUJBRVYsTUFJUHhCLEtBQUtPLFVBQVVrQixvQkFBc0IsV0FDakMsSUFBSVosRUFBT1osS0FDUHlCLEVBQVl2QixFQUFFLGVBQ2R3QixFQUFZeEIsRUFBRSxlQUNkeUIsRUFBV3pCLEVBQUUsY0FH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LEtBQUt3QyxvQkFDTHhDLEtBQUtnRSxvQkFDTGhFLEtBQUsrQix3QkFDTC9CLEtBQUt1Qix3QkFJVHJCLEVBQUU2RSxVQUFVQyxNQUFNLFlBQ0gsSUFBSWpGLE1BQ1YrRSxRQVVUekUsVUFBVUMsVUFBVXdFLElBQU0sV0FDdEI5RSxLQUFLaUYsc0JBR1Q1RSxVQUFVQyxVQUFVMkUsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVoRixFQUFFLGFBQ1ppRixFQUFjakYsRUFBRSxrQkFDcEJnRixFQUFRRSxNQUFNLFdBQ1ZELEVBQVkzRSxRQUNiLFdBQ0MyRSxFQUFZekUsVUFJcEJSLEVBQUU2RSxVQUFVQyxNQUFNLFlBQ0UsSUFBSTNFLFdBQ1Z5RSxNQUNOTyxXQUNBQSxTQUFTQyxTQUFTQyxRQUFRQyxVQUFZLFNBQVVDLEdBQzVDLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQVNGLEVBQUtHLFVBQ2xCakMsUUFBUUMsSUFBSStCLEdBQ1osSUFDSUUsSUFEUSxJQUFLSCxNQUFRRSxVQUNBRCxHQUFVLElBQ25DLE9BQUlFLEVBQVksR0FDTCxLQUNZLEdBQVpBLEdBQWtCQSxFQUFZLEtBQ3ZCeEQsU0FBU3dELEVBQVksSUFDbEIsTUFDRyxNQUFiQSxHQUF3QkEsRUFBWSxNQUMvQnhELFNBQVN3RCxFQUFZLEdBQUssSUFDdkIsTUFDSyxPQUFiQSxHQUE2QkEsRUFBWSxPQUNyQ3hELFNBQVN3RCxFQUFZLEdBQUssR0FBSyxJQUM1QixLQUVISixFQUFLSyxjQUtGLElBSkZMLEVBQUtNLFdBSVcsSUFIbEJOLEVBQUtPLFNBR3lCLElBRjdCUCxFQUFLUSxXQUVxQyxJQUR4Q1IsRUFBS1MiLCJmaWxlIjoiZnJvbnRfYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL+m7nuaTiueZu+mMhOaMiemIlSzlvYjlh7rmqKHmhYvlsI3oqbHmoYZcclxuLy/omZXnkIbnmbvpjITlkozms6jlhopcclxuZnVuY3Rpb24gQXV0aCgpIHtcclxuICAgIHRoaXMubWFza1dyYXBwZXIgPSAkKFwiLm1hc2std3JhcHBlclwiKTtcclxuICAgIHRoaXMuc2Nyb2xsV3JhcHBlciA9ICQoXCIuc2Nyb2xsLXdyYXBwZXJcIik7XHJcbiAgICB0aGlzLnNtc0NhcHRjaGEgPSAkKCcuc21zLWNhcHRjaGEtYnRuJyk7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubWFza1dyYXBwZXIuc2hvdygpO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLm1hc2tXcmFwcGVyLmhpZGUoKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIG1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oempl+itieeivOeZvOmAgeaIkOWKnycpXHJcbiAgICBzZWxmLnNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJylcclxuICAgIHZhciBjb3VudCA9IDYwXHJcbiAgICBzZWxmLnNtc0NhcHRjaGEudW5iaW5kKCdjbGljaycpXHJcbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoY291bnQgKyAncycpXHJcbiAgICAgICAgY291bnQgLT0gMVxyXG4gICAgICAgIGlmIChjb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpXHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKVxyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dCgn55m86YCB6amX6K2J56K8JylcclxuICAgICAgICAgICAgc2VsZi5saXN0ZW5TbXNDYXB0aGFFdmVudCgpXHJcbiAgICAgICAgfVxyXG4gICAgfSwgMTAwMClcclxufVxyXG5cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbmluQnRuID0gJChcIi5zaWduaW4tYnRuXCIpO1xyXG4gICAgdmFyIHNpZ251cEJ0biA9ICQoXCIuc2lnbnVwLWJ0blwiKTtcclxuICAgIHZhciBjbG9zZUJ0biA9ICQoXCIuY2xvc2UtYnRuXCIpO1xyXG5cclxuXHJcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6IFwiMFwifSlcclxuICAgIH0pXHJcbiAgICBzaWdudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KVxyXG4gICAgfSlcclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5oaWRlKCk7XHJcbiAgICB9KVxyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgaW1nQ2FwdGNoYSA9ICQoXCIuaW1nLWNhcHRjaGFcIik7XHJcbiAgICBpbWdDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+aUueiuiuWclueJh+eahOiri+axguWcsOWdgCzngI/opr3lmajmnIPph43mlrDnmbzpgIHoq4vmsYJcclxuICAgICAgICBpbWdDYXB0Y2hhLmF0dHIoXCJzcmNcIiwgXCIvYWNjb3VudC9pbWdfY2FwdGNoYS9cIiArIFwiP3JhbmRvbT1cIiArIE1hdGgucmFuZG9tKCkpXHJcbiAgICB9KVxyXG59XHJcblxyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc3dpdGNoZXIgPSAkKFwiLnN3aXRjaFwiKTtcclxuICAgIHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uICgpIHsvL+m7nuaTiuWIh+aPm+eZu+mMhC/ms6jlhornmoTpoIHpnaJcclxuXHJcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbiAgICAgICAgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRMZWZ0IDwgMCkge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiMFwifSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KVxyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWduaW5FdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoJy5zaWduaW4tZ3JvdXAnKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHZhciBwYXNzd29yZElucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkJ11cIik7XHJcbiAgICB2YXIgcmVtZW1iZXJJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdyZW1lbWJlciddXCIpO1xyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpXHJcbiAgICAgICAgdmFyIHBhc3N3b3JkID0gcGFzc3dvcmRJbnB1dC52YWwoKVxyXG4gICAgICAgIHZhciByZW1lbWJlciA9IHJlbWVtYmVySW5wdXQucHJvcChcImNoZWNrZWRcIilcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyID8gMSA6IDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KClcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzXHJcblxyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gJChcIi5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIilcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpXHJcbiAgICAgICAgY29uc29sZS5sb2codGVsZXBob25lKVxyXG4gICAgICAgIGlmICh0ZWxlcGhvbmUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd0luZm8oJ+iri+i8uOWFpeaJi+apn+iZn+eivCcpXHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHsndGVsZXBob25lJzogdGVsZXBob25lfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2Vzc0V2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfSlcclxufVxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzaWdudXBHcm91cCA9ICQoJy5zaWdudXAtZ3JvdXAnKTtcclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWdudXBHcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpXHJcbiAgICAgICAgdmFyIHVzZXJuYW1lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndXNlcm5hbWUnXVwiKVxyXG4gICAgICAgIHZhciBpbWdDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0naW1nX2NhcHRjaGEnXVwiKVxyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKVxyXG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDInXVwiKVxyXG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0nc21zX2NhcHRjaGEnXVwiKVxyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKClcclxuICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VybmFtZUlucHV0LnZhbCgpXHJcbiAgICAgICAgdmFyIGltZ19jYXB0Y2hhID0gaW1nQ2FwdGNoYUlucHV0LnZhbCgpXHJcbiAgICAgICAgY29uc29sZS5sb2coaW1nX2NhcHRjaGEpXHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpXHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMiA9IHBhc3N3b3JkMklucHV0LnZhbCgpXHJcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhID0gc21zQ2FwdGNoYUlucHV0LnZhbCgpXHJcblxyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3JlZ2lzdGVyLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ2ltZ19jYXB0Y2hhJzogaW1nX2NhcHRjaGEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMic6IHBhc3N3b3JkMixcclxuICAgICAgICAgICAgICAgICdzbXNfY2FwdGNoYSc6IHNtc19jYXB0Y2hhXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICB9KVxyXG59XHJcblxyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblN3aXRjaEV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblNpZ251cEV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgdGhpcy5saXN0ZW5TbXNDYXB0aGFFdmVudCgpO1xyXG5cclxufVxyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICAgYXV0aC5ydW4oKTtcclxufSlcclxuXHJcblxyXG4vL+iZleeQhuWwjuiIquainVxyXG5cclxuZnVuY3Rpb24gRnJvbnRCYXNlKCkge1xyXG5cclxufVxyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlbkF1dGhCb3hIb3ZlcigpXHJcbn1cclxuXHJcbkZyb250QmFzZS5wcm90b3R5cGUubGlzdGVuQXV0aEJveEhvdmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGF1dGhCb3ggPSAkKFwiLmF1dGgtYm94XCIpXHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIilcclxuICAgIGF1dGhCb3guaG92ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKVxyXG4gICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKVxyXG4gICAgfSlcclxufVxyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGZyb250QmFzZSA9IG5ldyBGcm9udEJhc2UoKVxyXG4gICAgZnJvbnRCYXNlLnJ1bigpXHJcbiAgICBpZiAodGVtcGxhdGUpIHtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpXHJcbiAgICAgICAgICAgIHZhciBkYXRldHMgPSBkYXRlLmdldFRpbWUoKS8v5ou/5Yiw5paH56ug55m85L2I5pmC6ZaT55qE5Lqz56eSXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGV0cylcclxuICAgICAgICAgICAgdmFyIG5vd3RzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKS8v5ou/5Yiw54++5Zyo5pmC6ZaT55qE5Lqz56eSXHJcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSAobm93dHMgLSBkYXRldHMpIC8gMTAwMC8v5Lqz56eS6L2J56eSXHJcbiAgICAgICAgICAgIGlmICh0aW1lc3RhbXAgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICfliZvliZsnXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID4gNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MClcclxuICAgICAgICAgICAgICAgIHJldHVybiBtaW51dGVzICsgJ+WIhumQmOWJjSdcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAmJiB0aW1lc3RhbXAgPCA2MCAqIDYwICogMjQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXJzICsgJ+Wwj+aZguWJjSdcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAqIDI0ICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCAqIDMwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKVxyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KClcclxuICAgICAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpXHJcbiAgICAgICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKClcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyICsgJy8nICsgbW9udGggKyAnLycgKyBkYXkgKyBcIiBcIiArIGhvdXIgKyBcIjpcIiArIG1pbnV0ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSJdfQ==
