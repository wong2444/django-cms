function Auth(){this.maskWrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper"),this.smsCaptcha=$(".sms-captcha-btn")}function FrontBase(){}Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信驗證碼發送成功"),t.smsCaptcha.addClass("disabled");var n=60;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),(n-=1)<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("發送驗證碼"),t.listenSmsCapthaEvent())},1e3)},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:"0"})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})}),a.click(function(){$(".mask-wrapper").hide()})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),i=t.find("input[name='password']"),o=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=i.val(),e=o.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){200===t.code&&(a.hideEvent(),window.location.reload())}})})},Auth.prototype.listenSmsCapthaEvent=function(){var n=this,e=$(".signup-group input[name='telephone']");n.smsCaptcha.click(function(){var t=e.val();console.log(t),""!==t?xfzajax.get({url:"account/sms_captcha/",data:{telephone:t},success:function(t){200===t.code&&n.smsSuccessEvent()}}):messageBox.showInfo("請輸入手機號碼")})},Auth.prototype.listenSignupEvent=function(){var m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),a=m.find("input[name='img_captcha']"),s=m.find("input[name='password1']"),i=m.find("input[name='password2']"),o=m.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),p=a.val();console.log(p);var u=s.val(),l=i.val(),h=o.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200===t.code&&window.location.reload()}})})},Auth.prototype.run=function(){this.listenShowHideEvent(),this.listenSwitchEvent(),this.listenSigninEvent(),this.listenSignupEvent(),this.listenImgCaptchaEvent(),this.listenSmsCapthaEvent()},$(document).ready(function(){(new Auth).run()}),FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},$(document).ready(function(){(new FrontBase).run(),window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime();console.log(e);var a=((new Date).getTime()-e)/1e3;return a<60?"剛剛":60<a&&a<3600?parseInt(a/60)+"分鐘前":3600<=a&&a<86400?parseInt(a/60/60)+"小時前":86400<=a&&a<2592e3?parseInt(a/60/60/24)+"天前":n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiQXV0aCIsInRoaXMiLCJtYXNrV3JhcHBlciIsIiQiLCJzY3JvbGxXcmFwcGVyIiwic21zQ2FwdGNoYSIsIkZyb250QmFzZSIsInByb3RvdHlwZSIsInNob3dFdmVudCIsInNob3ciLCJoaWRlRXZlbnQiLCJoaWRlIiwic21zU3VjY2Vzc0V2ZW50Iiwic2VsZiIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsImxpc3RlblNtc0NhcHRoYUV2ZW50IiwibGlzdGVuU2hvd0hpZGVFdmVudCIsInNpZ25pbkJ0biIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwiY2xpY2siLCJjc3MiLCJsZWZ0IiwibGlzdGVuSW1nQ2FwdGNoYUV2ZW50IiwiaW1nQ2FwdGNoYSIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwibGlzdGVuU3dpdGNoRXZlbnQiLCJjdXJyZW50TGVmdCIsInBhcnNlSW50IiwiYW5pbWF0ZSIsImxpc3RlblNpZ25pbkV2ZW50Iiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwieGZ6YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVsb2FkIiwiY29uc29sZSIsImxvZyIsImdldCIsInNob3dJbmZvIiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaWdudXBHcm91cCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VybmFtZUlucHV0IiwiaW1nQ2FwdGNoYUlucHV0IiwicGFzc3dvcmQxSW5wdXQiLCJwYXNzd29yZDJJbnB1dCIsInNtc0NhcHRjaGFJbnB1dCIsInVzZXJuYW1lIiwiaW1nX2NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJzbXNfY2FwdGNoYSIsInJ1biIsImRvY3VtZW50IiwicmVhZHkiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBRUEsU0FBU0EsT0FDTEMsS0FBS0MsWUFBY0MsRUFBRSxpQkFDckJGLEtBQUtHLGNBQWdCRCxFQUFFLG1CQUN2QkYsS0FBS0ksV0FBYUYsRUFBRSxvQkFnTXhCLFNBQVNHLGFBN0xUTixLQUFLTyxVQUFVQyxVQUFZLFdBQ3ZCUCxLQUFLQyxZQUFZTyxRQUdyQlQsS0FBS08sVUFBVUcsVUFBWSxXQUN2QlQsS0FBS0MsWUFBWVMsUUFHckJYLEtBQUtPLFVBQVVLLGdCQUFrQixXQUU3QixJQUFJQyxFQUFPWixLQUNYYSxXQUFXQyxZQUFZLGFBQ3ZCRixFQUFLUixXQUFXVyxTQUFTLFlBQ3pCLElBQUlDLEVBQVEsR0FDWkosRUFBS1IsV0FBV2EsT0FBTyxTQUN2QixJQUFJQyxFQUFRQyxZQUFZLFdBQ3BCUCxFQUFLUixXQUFXZ0IsS0FBS0osRUFBUSxNQUM3QkEsR0FBUyxJQUNJLElBQ1RLLGNBQWNILEdBQ2ROLEVBQUtSLFdBQVdrQixZQUFZLFlBQzVCVixFQUFLUixXQUFXZ0IsS0FBSyxTQUNyQlIsRUFBS1cseUJBRVYsTUFJUHhCLEtBQUtPLFVBQVVrQixvQkFBc0IsV0FDakMsSUFBSVosRUFBT1osS0FDUHlCLEVBQVl2QixFQUFFLGVBQ2R3QixFQUFZeEIsRUFBRSxlQUNkeUIsRUFBV3pCLEVBQUUsY0FH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LEtBQUt3QyxvQkFDTHhDLEtBQUtnRSxvQkFDTGhFLEtBQUsrQix3QkFDTC9CLEtBQUt1Qix3QkFJVHJCLEVBQUU2RSxVQUFVQyxNQUFNLFlBQ0gsSUFBSWpGLE1BQ1YrRSxRQVVUekUsVUFBVUMsVUFBVXdFLElBQU0sV0FDdEI5RSxLQUFLaUYsc0JBR1Q1RSxVQUFVQyxVQUFVMkUsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVoRixFQUFFLGFBQ1ppRixFQUFjakYsRUFBRSxrQkFDcEJnRixFQUFRRSxNQUFNLFdBQ1ZELEVBQVkzRSxRQUNiLFdBQ0MyRSxFQUFZekUsVUFJcEJSLEVBQUU2RSxVQUFVQyxNQUFNLFlBQ0UsSUFBSTNFLFdBQ1Z5RSxNQUNOckIsT0FBTzRCLFdBQ1BBLFNBQVNDLFNBQVNDLFFBQVFDLFVBQVksU0FBVUMsR0FDNUMsSUFBSUMsRUFBTyxJQUFJQyxLQUFLRixHQUNoQkcsRUFBU0YsRUFBS0csVUFDbEJqQyxRQUFRQyxJQUFJK0IsR0FDWixJQUNJRSxJQURRLElBQUtILE1BQVFFLFVBQ0FELEdBQVUsSUFDbkMsT0FBSUUsRUFBWSxHQUNMLEtBQ1ksR0FBWkEsR0FBa0JBLEVBQVksS0FDdkJ4RCxTQUFTd0QsRUFBWSxJQUNsQixNQUNHLE1BQWJBLEdBQXdCQSxFQUFZLE1BQy9CeEQsU0FBU3dELEVBQVksR0FBSyxJQUN2QixNQUNLLE9BQWJBLEdBQTZCQSxFQUFZLE9BQ3JDeEQsU0FBU3dELEVBQVksR0FBSyxHQUFLLElBQzVCLEtBRUhKLEVBQUtLLGNBS0YsSUFKRkwsRUFBS00sV0FJVyxJQUhsQk4sRUFBS08sU0FHeUIsSUFGN0JQLEVBQUtRLFdBRXFDLElBRHhDUixFQUFLUyIsImZpbGUiOiJmcm9udF9iYXNlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8v6bue5pOK55m76YyE5oyJ6YiVLOW9iOWHuuaooeaFi+WwjeipseahhlxyXG4vL+iZleeQhueZu+mMhOWSjOazqOWGilxyXG5mdW5jdGlvbiBBdXRoKCkge1xyXG4gICAgdGhpcy5tYXNrV3JhcHBlciA9ICQoXCIubWFzay13cmFwcGVyXCIpO1xyXG4gICAgdGhpcy5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuICAgIHRoaXMuc21zQ2FwdGNoYSA9ICQoJy5zbXMtY2FwdGNoYS1idG4nKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5tYXNrV3JhcHBlci5zaG93KCk7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubWFza1dyYXBwZXIuaGlkZSgpO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2Vzcygn55+t5L+h6amX6K2J56K855m86YCB5oiQ5YqfJylcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZWQnKVxyXG4gICAgdmFyIGNvdW50ID0gNjBcclxuICAgIHNlbGYuc21zQ2FwdGNoYS51bmJpbmQoJ2NsaWNrJylcclxuICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dChjb3VudCArICdzJylcclxuICAgICAgICBjb3VudCAtPSAxXHJcbiAgICAgICAgaWYgKGNvdW50IDw9IDApIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcilcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpXHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KCfnmbzpgIHpqZforYnnorwnKVxyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRoYUV2ZW50KClcclxuICAgICAgICB9XHJcbiAgICB9LCAxMDAwKVxyXG59XHJcblxyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2hvd0hpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5CdG4gPSAkKFwiLnNpZ25pbi1idG5cIik7XHJcbiAgICB2YXIgc2lnbnVwQnRuID0gJChcIi5zaWdudXAtYnRuXCIpO1xyXG4gICAgdmFyIGNsb3NlQnRuID0gJChcIi5jbG9zZS1idG5cIik7XHJcblxyXG5cclxuICAgIHNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogXCIwXCJ9KVxyXG4gICAgfSlcclxuICAgIHNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogXCItNDAwcHhcIn0pXHJcbiAgICB9KVxyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoXCIubWFzay13cmFwcGVyXCIpLmhpZGUoKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkltZ0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBpbWdDYXB0Y2hhID0gJChcIi5pbWctY2FwdGNoYVwiKTtcclxuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8v5pS56K6K5ZyW54mH55qE6KuL5rGC5Zyw5Z2ALOeAj+imveWZqOacg+mHjeaWsOeZvOmAgeiri+axglxyXG4gICAgICAgIGltZ0NhcHRjaGEuYXR0cihcInNyY1wiLCBcIi9hY2NvdW50L2ltZ19jYXB0Y2hhL1wiICsgXCI/cmFuZG9tPVwiICsgTWF0aC5yYW5kb20oKSlcclxuICAgIH0pXHJcbn1cclxuXHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzd2l0Y2hlciA9ICQoXCIuc3dpdGNoXCIpO1xyXG4gICAgc3dpdGNoZXIuY2xpY2soZnVuY3Rpb24gKCkgey8v6bue5pOK5YiH5o+b55m76YyEL+azqOWGiueahOmggemdolxyXG5cclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuICAgICAgICBpZiAoY3VycmVudExlZnQgPCAwKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCIwXCJ9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCItNDAwcHhcIn0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pXHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbmluR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKClcclxuICAgICAgICB2YXIgcGFzc3dvcmQgPSBwYXNzd29yZElucHV0LnZhbCgpXHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKVxyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXIgPyAxIDogMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn1cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGhhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXNcclxuXHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKVxyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKClcclxuICAgICAgICBjb25zb2xlLmxvZyh0ZWxlcGhvbmUpXHJcbiAgICAgICAgaWYgKHRlbGVwaG9uZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygn6KuL6Ly45YWl5omL5qmf6Jmf56K8JylcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHhmemFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICdhY2NvdW50L3Ntc19jYXB0Y2hhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzogeyd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmV9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9KVxyXG59XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNpZ251cEdyb3VwID0gJCgnLnNpZ251cC1ncm91cCcpO1xyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoJy5zdWJtaXQtYnRuJyk7XHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIilcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpXHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpXHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpXHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMklucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMiddXCIpXHJcbiAgICAgICAgdmFyIHNtc0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpXHJcblxyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKVxyXG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKClcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKClcclxuICAgICAgICBjb25zb2xlLmxvZyhpbWdfY2FwdGNoYSlcclxuICAgICAgICB2YXIgcGFzc3dvcmQxID0gcGFzc3dvcmQxSW5wdXQudmFsKClcclxuICAgICAgICB2YXIgcGFzc3dvcmQyID0gcGFzc3dvcmQySW5wdXQudmFsKClcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGEgPSBzbXNDYXB0Y2hhSW5wdXQudmFsKClcclxuXHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvcmVnaXN0ZXIvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQyJzogcGFzc3dvcmQyLFxyXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pXHJcblxyXG5cclxuICAgIH0pXHJcbn1cclxuXHJcblxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuU2lnbnVwRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuSW1nQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblNtc0NhcHRoYUV2ZW50KCk7XHJcblxyXG59XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgICBhdXRoLnJ1bigpO1xyXG59KVxyXG5cclxuXHJcbi8v6JmV55CG5bCO6Iiq5qKdXHJcblxyXG5mdW5jdGlvbiBGcm9udEJhc2UoKSB7XHJcblxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubGlzdGVuQXV0aEJveEhvdmVyKClcclxufVxyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIilcclxuICAgIHZhciB1c2VyTW9yZUJveCA9ICQoXCIudXNlci1tb3JlLWJveFwiKVxyXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpXHJcbiAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guaGlkZSgpXHJcbiAgICB9KVxyXG59XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZnJvbnRCYXNlID0gbmV3IEZyb250QmFzZSgpXHJcbiAgICBmcm9udEJhc2UucnVuKClcclxuICAgIGlmICh3aW5kb3cudGVtcGxhdGUpIHtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpXHJcbiAgICAgICAgICAgIHZhciBkYXRldHMgPSBkYXRlLmdldFRpbWUoKS8v5ou/5Yiw5paH56ug55m85L2I5pmC6ZaT55qE5Lqz56eSXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGV0cylcclxuICAgICAgICAgICAgdmFyIG5vd3RzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKS8v5ou/5Yiw54++5Zyo5pmC6ZaT55qE5Lqz56eSXHJcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSAobm93dHMgLSBkYXRldHMpIC8gMTAwMC8v5Lqz56eS6L2J56eSXHJcbiAgICAgICAgICAgIGlmICh0aW1lc3RhbXAgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICfliZvliZsnXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID4gNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MClcclxuICAgICAgICAgICAgICAgIHJldHVybiBtaW51dGVzICsgJ+WIhumQmOWJjSdcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAmJiB0aW1lc3RhbXAgPCA2MCAqIDYwICogMjQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXJzICsgJ+Wwj+aZguWJjSdcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAqIDI0ICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCAqIDMwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKVxyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KClcclxuICAgICAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpXHJcbiAgICAgICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKClcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyICsgJy8nICsgbW9udGggKyAnLycgKyBkYXkgKyBcIiBcIiArIGhvdXIgKyBcIjpcIiArIG1pbnV0ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSJdfQ==
